import{r as b}from"./index-4g5l5LRQ.js";import{g as y}from"./_commonjsHelpers-4gQjN7DL.js";import{u as S}from"./index-tNdqmU4a.js";var c={exports:{}};(function(i){function s(t){if(t=Object.assign({},t),!(this instanceof s))throw new Error("MapboxLanguage needs to be called with the new keyword");this.setLanguage=this.setLanguage.bind(this),this._initialStyleUpdate=this._initialStyleUpdate.bind(this),this._defaultLanguage=t.defaultLanguage,this._isLanguageField=t.languageField||/^name_/,this._getLanguageField=t.getLanguageField||function(a){return a==="mul"?"name":`name_${a}`},this._languageSource=t.languageSource||null,this._languageTransform=t.languageTransform,this._excludedLayerIds=t.excludedLayerIds||[],this.supportedLanguages=t.supportedLanguages||["ar","de","en","es","fr","it","ja","ko","mul","pt","ru","vi","zh-Hans","zh-Hant"]}const f=/^\{name/;function r(t,e){const a=Array.isArray(e)&&e[0]==="get";return a&&f.test(e[1])&&console.warn("This plugin no longer supports the use of token syntax (e.g. {name}). Please use a get expression. See https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/ for more details."),a&&t.test(e[1])}function u(t,e,a){if(Array.isArray(e))for(let n=1;n<e.length;n++)Array.isArray(e[n])&&(r(t,e[n])&&(e[n][1]=a),u(t,e[n],a))}function h(t,e,a){if(r(t,e)&&(e[1]=a),u(t,e,a),e[0]==="get"&&e[1]==="name"){const n=e.slice();e=["coalesce",["get",a],n]}return e}function p(t,e,a,n){return e.layout&&e.layout["text-field"]&&n.indexOf(e.id)===-1?Object.assign({},e,{layout:Object.assign({},e.layout,{"text-field":h(t,e.layout["text-field"],a)})}):e}function m(t){const e=Object.keys(t.sources).filter(a=>{const n=t.sources[a].url;return n&&n.indexOf("mapbox.mapbox-streets-v8")>-1||/mapbox-streets-v[1-9][1-9]/.test(n)});if(!e.length)throw new Error('If using MapboxLanguage with a Mapbox style, the style must be based on vector tile version 8, e.g. "streets-v11"');return e[0]}s.prototype.setLanguage=function(t,e){if(this.supportedLanguages.indexOf(e)<0)throw new Error(`Language ${e} is not supported`);const a=this._languageSource||m(t);if(!a)return t;const n=this._getLanguageField(e),g=this._isLanguageField,L=this._excludedLayerIds,_=t.layers.map(o=>o.source===a?p(g,o,n,L):o),l=Object.assign({},t,{layers:_});return this._languageTransform?this._languageTransform(l,e):l},s.prototype._initialStyleUpdate=function(){const t=this._map.getStyle(),e=this._defaultLanguage||x(this.supportedLanguages);this._map.setStyle(this.setLanguage(t,e))};function x(t){const e=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,a=e&&e.split("-");let n=e;return a.length>1&&(n=a[0]),t.indexOf(n)>-1?n:null}s.prototype.onAdd=function(t){return this._map=t,this._map.on("style.load",this._initialStyleUpdate),this._container=document.createElement("div"),this._container},s.prototype.onRemove=function(){this._map.off("style.load",this._initialStyleUpdate),this._map=void 0},i.exports=s})(c);var v=c.exports;const w=y(v),d=()=>{const{map:i}=S();return b.useEffect(()=>{if(i){const s=new w({defaultLanguage:"zh-Hans"});i.addControl(s)}},[i]),null};try{d.displayName="Language",d.__docgenInfo={description:"",displayName:"Language",props:{}}}catch{}export{d as L};
