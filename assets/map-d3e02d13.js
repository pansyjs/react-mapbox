import{a as V,j as b}from"./jsx-runtime-29545a09.js";import{M as T}from"./mapbox-gl-801b965a.js";import{r as d}from"./index-76fb7be0.js";const Z=d.createContext({});function w(n){var e=d.useRef(n);return e.current=n,e}var P=!!(typeof window<"u"&&window.document&&window.document.createElement),y,M;P&&(!((y=window)===null||y===void 0||(M=y.navigator)===null||M===void 0)&&M.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);var L=function(e){return typeof e=="function"};function E(n){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(n)}function x(n,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=new Set;function i(a,u){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,m=o.has(a);if(m)return!1;if(a===u)return!0;if(r&&l>1)return!1;o.add(a);var t=l+1;if(Array.isArray(a)){if(!Array.isArray(u)||a.length!==u.length)return!1;for(var c=0;c<a.length;c++)if(!i(a[c],u[c],t))return!1;return!0}if(a&&u&&E(a)==="object"&&E(u)==="object"){var s=Object.keys(a);return s.length!==Object.keys(u).length?!1:s.every(function(f){return i(a[f],u[f],t)})}return!1}return i(n,e)}var B=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return x(e,r)},F=function(e){return function(r,o){var i=d.useRef(),a=d.useRef(0);(o===void 0||!B(o,i.current))&&(i.current=o,a.current+=1),e(r,[a.current])}};function h(n){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(n)}function D(n){typeof n!="function"&&console.error("useUnmount expected parameter is a function, got ".concat(h(n)));var e=w(n);d.useEffect(function(){return function(){e.current()}},[])}var W=F(d.useEffect),I=function(e,r){return e!==r};function _(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:I,r=d.useRef(),o=d.useRef();return e(o.current,n)&&(r.current=o.current,o.current=n),r.current}const O=(n,e)=>n?n.map((r,o)=>Object.is(n[o],e==null?void 0:e[o])?-1:o).filter(r=>r>=0):e?e.map((r,o)=>o):[],z=(n,e)=>{const r=d.useRef();d.useEffect(()=>{const o=O(r.current,e),i=r.current;return r.current=e,n(o,i,e)},e)},A=(n,e,r)=>{const{eventMap:o={},eventList:i=[]}=r;z((a=[],u,l)=>{if(!n)return;let m=a.filter(t=>!!t).map(t=>t-1);a.includes(0)&&(m=i.map((t,c)=>c)),m.forEach(t=>{const c=o[i[t]],s=u==null?void 0:u[t+1],f=l==null?void 0:l[t+1];s&&n.off(c,s),f&&n.on(c,f)})},[n,...i.map(a=>e[a])]),D(()=>{n&&i.forEach(a=>{const u=o[a],l=e[a];u&&l&&n.off(u,l)})})},N=n=>n[0].toUpperCase()+n.slice(1,n.length);function k(n,e,{setterMap:r={},converterMap:o={}}={}){const i=_(n);W(()=>{e&&u(n,!0)},[n]),D(()=>{e&&"remove"in e&&e.remove()});const a=()=>{u(n,!1)},u=(l,m=!0)=>{if(e)try{Object.keys(l).forEach(t=>{if(L(n[t])&&/^on[A-Z]/.test(t))return;let c=!0;if(m&&(c=!x(l[t],i==null?void 0:i[t])),!c)return;let s=l[t];if(t in o&&(s=o[t](l[t])),t in r)r[t](s,e);else{const f=`set${N(t)}`;f in e&&e[f](s)}})}catch(t){console.error(t)}};return{onInstanceCreated:a}}const U=["accessToken","antialias","attributionControl","bearingSnap","bounds","hash","interactive","clickTolerance","pitchWithRotate","customAttribution","cooperativeGestures","logoPosition","failIfMajorPerformanceCaveat","preserveDrawingBuffer","refreshExpiredTiles","trackResize","fitBoundsOptions","maxTileCacheSize","transformRequest","collectResourceTiming","fadeDuration","crossSourceCollisions","optimizeForTerrain","locale","localFontFamily","localIdeographFontFamily","testMode"],j=["center","zoom","minZoom","maxZoom","style","maxBounds","dragPan","renderWorldCopies","pitch","maxPitch","minPitch","bearing","projection","touchPitch","boxZoom","scrollZoom","dragRotate","dragPan","keyboard","touchZoomRotate","doubleClickZoom"],$=j.concat(U),G={touchPitch(n,e){if(e){if(n){e.touchPitch.enable();return}e.touchPitch.disable()}},scrollZoom(n,e){if(e){if(n){e.scrollZoom.enable();return}e.scrollZoom.disable()}},boxZoom(n,e){if(e){if(n){e.boxZoom.enable();return}e.boxZoom.disable()}},dragRotate(n,e){if(e){if(n){e.dragRotate.enable();return}e.dragRotate.disable()}},dragPan(n,e){if(e){if(n){e.dragPan.enable();return}e.dragPan.disable()}},keyboard(n,e){if(e){if(n){e.keyboard.enable();return}e.keyboard.disable()}},touchZoomRotate(n,e){if(e){if(n){e.touchZoomRotate.enable();return}e.touchZoomRotate.disable()}},doubleClickZoom(n,e){if(e){if(n){e.doubleClickZoom.enable();return}e.doubleClickZoom.disable()}}},H={},q={onError:"error",onLoad:"load",onIdle:"idle",onRemove:"remove",onRender:"render",onResize:"resize",onWebglContextLost:"webglcontextlost",onWebglContextRestored:"webglcontextrestored",onDataloading:"dataloading",onData:"data",onTileDataLoading:"tiledataloading",onSourceDataLoading:"sourcedataloading",onStyleDataLoading:"styledataloading",onStyleLoad:"style.load",onStyleImportLoad:"style.import.load",onSourceData:"sourcedata",onStyleData:"styledata",onBoxZoomCancel:"boxzoomcancel",onBoxZoomStart:"boxzoomstart",onBoxZoomEnd:"boxzoomend",onTouchCancel:"touchcancel",onTouchMove:"touchmove",onTouchEnd:"touchend",onTouchStart:"touchstart",onClick:"click",onContextMenu:"contextmenu",onDoubleClick:"dblclick",onMouseMove:"mousemove",onMouseUp:"mouseup",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMoveStart:"movestart",onMove:"move",onMoveEnd:"moveend",onZoomStart:"zoomstart",onZoom:"zoom",onZoomEnd:"zoomend",onRotateStart:"rotatestart",onRotate:"rotate",onRotateEnd:"rotateend",onDragStart:"dragstart",onDrag:"drag",onDragEnd:"dragend",onPitchStart:"pitchstart",onPitch:"pitch",onPitchEnd:"pitchend",onWheel:"wheel"},Y=Object.keys(q);const S=d.forwardRef((n,e)=>{const{className:r,loading:o,containerStyle:i,children:a}=n,u=d.useRef(null),[l,m]=d.useState(),t=d.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.containerStyle}),[n.style]),{current:c}=d.useRef({}),{onInstanceCreated:s}=k(n,l,{setterMap:G,converterMap:H});A(l,n,{eventMap:q,eventList:Y}),d.useImperativeHandle(e,()=>l,[l]),d.useEffect(()=>{u.current&&f().then(v=>{s(),c.map=v,m(v)})},[u]);const f=()=>{const v=C(n);return Promise.resolve(new T.Map(v))},C=v=>{const g={container:u.current};return $.forEach(p=>{p in v&&p!=="container"&&(g[p]=v[p])}),g},R={height:"100%"};return V("div",{ref:u,style:t,className:r,children:[!l&&o,l&&b(Z.Provider,{value:c,children:b("div",{"mapboxgl-children":"",style:R,children:a})})]})});try{S.displayName="Map",S.__docgenInfo={description:"",displayName:"Map",props:{loading:{defaultValue:null,description:"地图加载前的加载效果",name:"loading",required:!1,type:{name:"ReactNode"}},className:{defaultValue:null,description:"额外的样式类",name:"className",required:!1,type:{name:"string"}},containerStyle:{defaultValue:null,description:"地图挂载节点样式",name:"containerStyle",required:!1,type:{name:"CSSProperties"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"((e: ErrorEvent) => void)"}},onLoad:{defaultValue:null,description:`下载所有必要的资源并且第一次视觉上完整渲染发生后触发
@param e
@returns`,name:"onLoad",required:!1,type:{name:"((e: MapboxEvent<undefined>) => void)"}},onIdle:{defaultValue:null,description:"",name:"onIdle",required:!1,type:{name:"((e: MapboxEvent<undefined>) => void)"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!1,type:{name:"((e: MapboxEvent<undefined>) => void)"}},onRender:{defaultValue:null,description:"",name:"onRender",required:!1,type:{name:"((e: MapboxEvent<undefined>) => void)"}},onResize:{defaultValue:null,description:"",name:"onResize",required:!1,type:{name:"((e: MapboxEvent<undefined>) => void)"}},onWebglContextLost:{defaultValue:null,description:"",name:"onWebglContextLost",required:!1,type:{name:"((e: MapContextEvent) => void)"}},onWebglContextRestored:{defaultValue:null,description:"",name:"onWebglContextRestored",required:!1,type:{name:"((e: MapContextEvent) => void)"}},onDataloading:{defaultValue:null,description:"",name:"onDataloading",required:!1,type:{name:"((e: MapDataEvent) => void)"}},onData:{defaultValue:null,description:"",name:"onData",required:!1,type:{name:"((e: MapDataEvent) => void)"}},onTileDataLoading:{defaultValue:null,description:"",name:"onTileDataLoading",required:!1,type:{name:"((e: MapDataEvent) => void)"}},onSourceDataLoading:{defaultValue:null,description:"",name:"onSourceDataLoading",required:!1,type:{name:"((e: MapSourceDataEvent) => void)"}},onStyleDataLoading:{defaultValue:null,description:"",name:"onStyleDataLoading",required:!1,type:{name:"((e: MapStyleDataEvent) => void)"}},onStyleLoad:{defaultValue:null,description:"",name:"onStyleLoad",required:!1,type:{name:'((e: Omit<MapStyleDataEvent, "dataType"> & { type: "style.load"; }) => void)'}},onStyleImportLoad:{defaultValue:null,description:"",name:"onStyleImportLoad",required:!1,type:{name:'((e: Omit<MapStyleDataEvent, "dataType"> & { type: "style.import.load"; }) => void)'}},onSourceData:{defaultValue:null,description:"",name:"onSourceData",required:!1,type:{name:"((e: MapSourceDataEvent) => void)"}},onStyleData:{defaultValue:null,description:"",name:"onStyleData",required:!1,type:{name:"((e: MapStyleDataEvent) => void)"}},onBoxZoomCancel:{defaultValue:null,description:"",name:"onBoxZoomCancel",required:!1,type:{name:"((e: MapBoxZoomEvent) => void)"}},onBoxZoomStart:{defaultValue:null,description:"",name:"onBoxZoomStart",required:!1,type:{name:"((e: MapBoxZoomEvent) => void)"}},onBoxZoomEnd:{defaultValue:null,description:"",name:"onBoxZoomEnd",required:!1,type:{name:"((e: MapBoxZoomEvent) => void)"}},onTouchCancel:{defaultValue:null,description:"",name:"onTouchCancel",required:!1,type:{name:"((e: MapTouchEvent) => void)"}},onTouchMove:{defaultValue:null,description:"",name:"onTouchMove",required:!1,type:{name:"((e: MapTouchEvent) => void)"}},onTouchEnd:{defaultValue:null,description:"",name:"onTouchEnd",required:!1,type:{name:"((e: MapTouchEvent) => void)"}},onTouchStart:{defaultValue:null,description:"",name:"onTouchStart",required:!1,type:{name:"((e: MapTouchEvent) => void)"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onContextMenu:{defaultValue:null,description:"",name:"onContextMenu",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onDoubleClick:{defaultValue:null,description:"",name:"onDoubleClick",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onMouseMove:{defaultValue:null,description:"",name:"onMouseMove",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onMouseUp:{defaultValue:null,description:"",name:"onMouseUp",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onMouseDown:{defaultValue:null,description:"",name:"onMouseDown",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onMouseOut:{defaultValue:null,description:"",name:"onMouseOut",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onMouseOver:{defaultValue:null,description:"",name:"onMouseOver",required:!1,type:{name:"((e: MapMouseEvent) => void)"}},onMoveStart:{defaultValue:null,description:"",name:"onMoveStart",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent | WheelEvent>) => void)"}},onMove:{defaultValue:null,description:"",name:"onMove",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent | WheelEvent>) => void)"}},onMoveEnd:{defaultValue:null,description:"",name:"onMoveEnd",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent | WheelEvent>) => void)"}},onZoomStart:{defaultValue:null,description:"",name:"onZoomStart",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent | WheelEvent>) => void)"}},onZoom:{defaultValue:null,description:"",name:"onZoom",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent | WheelEvent>) => void)"}},onZoomEnd:{defaultValue:null,description:"",name:"onZoomEnd",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent | WheelEvent>) => void)"}},onRotateStart:{defaultValue:null,description:"",name:"onRotateStart",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onRotate:{defaultValue:null,description:"",name:"onRotate",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onRotateEnd:{defaultValue:null,description:"",name:"onRotateEnd",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onDrag:{defaultValue:null,description:"",name:"onDrag",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onPitchStart:{defaultValue:null,description:"",name:"onPitchStart",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onPitch:{defaultValue:null,description:"",name:"onPitch",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onPitchEnd:{defaultValue:null,description:"",name:"onPitchEnd",required:!1,type:{name:"((e: MapboxEvent<MouseEvent | TouchEvent>) => void)"}},onWheel:{defaultValue:null,description:"",name:"onWheel",required:!1,type:{name:"((e: MapWheelEvent) => void)"}}}}}catch{}export{S as M,Z as a,A as b,L as i,k as u};
